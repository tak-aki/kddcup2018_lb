{% extends "submit/base.html" %}
{% block title %}My Submission Detail{% endblock title %}
{% load staticfiles %}
      {% block body %}
      <div id="wrapper">
        <div id="page-wrapper">
          <div class="row">
            <div class="col-lg-6 full-width margin-top-20percent" >
              <h2 align="center">My Submission Detail</h2>
                <table id="submit-result-table" class="table table-striped table-bordered table-hover dataTable no-footer dtr-inline full-width">
                    <thead>
                      <tr>
                        <th class="score_table">提出日時</th>
                        <th class="score_table">ユーザー名</th>
                        <th class="score_table">ファイル名</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="score_table">{{submit_timestamp}}</td>
                        <td class="score_table">{{submit_username}}</td>
                        <td class="score_table">{{submit_filename}}</td>
                      </tr>
                    </tbody>
                  </table>

                  <table id="submit-result-table" class="table table-striped table-bordered table-hover dataTable no-footer dtr-inline full-width">
                    <tbody>
                      <tr>
                        <th class="score_table">スコア日</th>
                        <th class="score_table">スコア</th>
                      </tr>
                      {% for score in scores %}
                      <tr>
                        <td class="score_table">{{score.score_date}}</td>
                        <td class="score_table">{{score.score}}</td>
                      </tr>
                      {% endfor %}
                      <tr>
                        <td colspan="2">
                          {% for chart in charts %}
                          <div id="container_{{chart.city}}_{{chart.target}}" style="min-width: 310px; max-width: 800px; height: 400px; margin: 0 auto;"></div>
                          <script type="text/javascript">
                            Highcharts.setOptions({
                                global : {
                                    useUTC : false
                                }
                            });
                            Highcharts.chart('container_{{chart.city}}_{{chart.target}}', {
                              title: {
                                  text: '{{chart.city}} {{chart.target}}'
                              },

                              subtitle: {
                                  text: ''
                              },

                              xAxis: {
                                type: 'datetime',
                                dateTimeLabelFormats: {
                                        minute: '%H:%M',
                                        hour: '%m/%d %H:%M',
                                        day: '%Y/%m/%d',
                                        week: '%Y/%m/%d',
                                        month: '%Y/%m',
                                        year: '(%Y)'
                                    }
                              },

                              yAxis: {
                                  title: {
                                      text: '{{chart.target}}'
                                  }
                              },
                              legend: {
                                  layout: 'vertical',
                                  align: 'right',
                                  verticalAlign: 'middle'
                              },

                              plotOptions: {
                                  series: {
                                      label: {
                                          connectorAllowed: false
                                      },
                                      pointStart: 2010
                                  }
                              },

                              series: [
                              {% for chart_data in chart.chart_data_series %}
                              {
                                  name: '{{chart_data.name}}',
                                  data: {{chart_data.data|safe}},
                                  pointStart: Date.parse('{{chart_data.start_dt|safe}}'),
                                  pointInterval: 3600 * 1000
                              },
                              {% endfor %}
                              ],

                              responsive: {
                                  rules: [{
                                      condition: {
                                          maxWidth: 500
                                      },
                                      chartOptions: {
                                          legend: {
                                              layout: 'horizontal',
                                              align: 'center',
                                              verticalAlign: 'bottom'
                                          }
                                      }
                                  }]
                              }
                            });
                          </script>
                          {% endfor %}
                        </td>
                      </tr>
                    </tbody>
                  </table>
                  
            </div>
          </div>
        </div>
      </div>
      {% endblock %}
